<% content_for :title, "Profil | Raidators" %>

<div class="container my-5">

  <!-- Section: Block Content -->
  <section class="team-section">

    <div class="card">
      <div class="card-header white d-flex justify-content-between">
        <p class="h3-responsive font-weight-bold mb-0">Bonjour <%= @user.email.split('@')[0].capitalize %>, voici votre profil</p>
      </div>
      <div class="card-body">
        <div class="row pt-4">
          <div class="col-lg-3 col-md-4 col-sm-6 pb-4">
            <div class="avatar white text-center">
            <%# Active storage %>
              <img src="https://mdbootstrap.com/img/Photos/Avatars/img%20(9).jpg" class="img-fluid rounded-circle z-depth-1"/>
            </div>
          </div>
        </div>
      </div>  
    </div>

  </section>
  <!-- Section: Block Content -->

</div>

<div class="container my-5">

  
  <!-- Section: Block Content -->
  <section>
    
    <div class="row">
      <div class="col-12">
      	<div class="card card-list">
          <div class="card-header white d-flex justify-content-between align-items-center py-3">
            <p class="h5-responsive font-weight-bold mb-0">Vos commandes</p>
          </div>
          <div class="card-body">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">N° commande</th>
                  <th scope="col">Prix</th>
                  <th scope="col">Quantité</th>
                  <th scope="col">Total</th>
                </tr>
              </thead>
              <tbody>
                <% @orders.each do |order| %>
                  <tr>
                    <th><strong><%= order.id %></strong></th>
                    <% total = 0 %>
                    <% order.join_order_products.each do |order_product| %>
                      <% total += order_product.quantity * order_product.product.price %>
                      <tr>
                        <th class="text-center"><strong><%= order_product.product.title %></strong></th>
                        <th class="text-center"><%= order_product.product.price %></th>
                        <th class="text-center"><%= order_product.quantity %></th>
                        <th class="text-center"><%= order_product.quantity * order_product.product.price %></th>
                      </tr>
                    <% end %>
                    <th class="text-right">Total du prix de la commande : <strong><%= total %></strong></th>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
          <div class="card-footer white py-3 d-flex justify-content-between">
            <button type="button" class="btn btn-outline-primary"><%= link_to "Créer Adresse",new_address_path %></button>
            <button type="button" class="btn btn-outline-primary"><%= link_to "Mes adresses",addresses_path %></button>
            <button type="button" class="btn btn-outline-primary"><%= link_to "Modifier mon mot de passe",edit_user_registration_path %></button>
          </div>
        </div>
      </div>
    </div>

  </section>
  <!-- Section: Block Content -->

  
</div>